
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A minimal implementation of Gaussian Mixture Models in Jax">
      
      
        <meta name="author" content="Axel Donath">
      
      
        <link rel="canonical" href="https://adonath.github.io/gmmx/modules/">
      
      
        <link rel="prev" href="..">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.48">
    
    
      
        <title>Modules - gmmx</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#gmmx.gmm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="gmmx" class="md-header__button md-logo" aria-label="gmmx" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            gmmx
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Modules
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/adonath/gmmx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    adonath/gmmx
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="gmmx" class="md-nav__button md-logo" aria-label="gmmx" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    gmmx
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/adonath/gmmx" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    adonath/gmmx
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Modules
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Modules
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm" class="md-nav__link">
    <span class="md-ellipsis">
      gmm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.Axis" class="md-nav__link">
    <span class="md-ellipsis">
      Axis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.CovarianceType" class="md-nav__link">
    <span class="md-ellipsis">
      CovarianceType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances" class="md-nav__link">
    <span class="md-ellipsis">
      FullCovariances
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FullCovariances">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.log_det_cholesky" class="md-nav__link">
    <span class="md-ellipsis">
      log_det_cholesky
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.n_components" class="md-nav__link">
    <span class="md-ellipsis">
      n_components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.n_features" class="md-nav__link">
    <span class="md-ellipsis">
      n_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.n_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      n_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.precisions_cholesky" class="md-nav__link">
    <span class="md-ellipsis">
      precisions_cholesky
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.precisions_cholesky_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      precisions_cholesky_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.values_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      values_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.create--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.create--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.from_squeezed" class="md-nav__link">
    <span class="md-ellipsis">
      from_squeezed
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_squeezed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.from_squeezed--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.from_squeezed--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.log_prob" class="md-nav__link">
    <span class="md-ellipsis">
      log_prob
    </span>
  </a>
  
    <nav class="md-nav" aria-label="log_prob">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.log_prob--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.log_prob--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.update_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      update_parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="update_parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.update_parameters--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.update_parameters--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax" class="md-nav__link">
    <span class="md-ellipsis">
      GaussianMixtureModelJax
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GaussianMixtureModelJax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.log_weights" class="md-nav__link">
    <span class="md-ellipsis">
      log_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.means_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      means_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.n_components" class="md-nav__link">
    <span class="md-ellipsis">
      n_components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.n_features" class="md-nav__link">
    <span class="md-ellipsis">
      n_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.n_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      n_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.weights_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      weights_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.create--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.create--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_log_prob
    </span>
  </a>
  
    <nav class="md-nav" aria-label="estimate_log_prob">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_k_means" class="md-nav__link">
    <span class="md-ellipsis">
      from_k_means
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_k_means">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_k_means--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_k_means--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_squeezed" class="md-nav__link">
    <span class="md-ellipsis">
      from_squeezed
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_squeezed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_squeezed--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_squeezed--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="predict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.predict--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.predict--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.sample--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.to_sklearn" class="md-nav__link">
    <span class="md-ellipsis">
      to_sklearn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_sklearn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.to_sklearn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.to_sklearn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.update_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      update_parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="update_parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.update_parameters--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.update_parameters--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.check_shape" class="md-nav__link">
    <span class="md-ellipsis">
      check_shape
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm" class="md-nav__link">
    <span class="md-ellipsis">
      gmm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.Axis" class="md-nav__link">
    <span class="md-ellipsis">
      Axis
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.CovarianceType" class="md-nav__link">
    <span class="md-ellipsis">
      CovarianceType
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances" class="md-nav__link">
    <span class="md-ellipsis">
      FullCovariances
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FullCovariances">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.log_det_cholesky" class="md-nav__link">
    <span class="md-ellipsis">
      log_det_cholesky
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.n_components" class="md-nav__link">
    <span class="md-ellipsis">
      n_components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.n_features" class="md-nav__link">
    <span class="md-ellipsis">
      n_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.n_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      n_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.precisions_cholesky" class="md-nav__link">
    <span class="md-ellipsis">
      precisions_cholesky
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.precisions_cholesky_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      precisions_cholesky_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.values_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      values_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.create--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.create--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.from_squeezed" class="md-nav__link">
    <span class="md-ellipsis">
      from_squeezed
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_squeezed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.from_squeezed--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.from_squeezed--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.log_prob" class="md-nav__link">
    <span class="md-ellipsis">
      log_prob
    </span>
  </a>
  
    <nav class="md-nav" aria-label="log_prob">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.log_prob--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.log_prob--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.update_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      update_parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="update_parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.update_parameters--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.FullCovariances.update_parameters--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax" class="md-nav__link">
    <span class="md-ellipsis">
      GaussianMixtureModelJax
    </span>
  </a>
  
    <nav class="md-nav" aria-label="GaussianMixtureModelJax">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax--attributes" class="md-nav__link">
    <span class="md-ellipsis">
      Attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.log_weights" class="md-nav__link">
    <span class="md-ellipsis">
      log_weights
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.means_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      means_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.n_components" class="md-nav__link">
    <span class="md-ellipsis">
      n_components
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.n_features" class="md-nav__link">
    <span class="md-ellipsis">
      n_features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.n_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      n_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.weights_numpy" class="md-nav__link">
    <span class="md-ellipsis">
      weights_numpy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.create" class="md-nav__link">
    <span class="md-ellipsis">
      create
    </span>
  </a>
  
    <nav class="md-nav" aria-label="create">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.create--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.create--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_log_prob
    </span>
  </a>
  
    <nav class="md-nav" aria-label="estimate_log_prob">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_k_means" class="md-nav__link">
    <span class="md-ellipsis">
      from_k_means
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_k_means">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_k_means--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_k_means--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_squeezed" class="md-nav__link">
    <span class="md-ellipsis">
      from_squeezed
    </span>
  </a>
  
    <nav class="md-nav" aria-label="from_squeezed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_squeezed--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.from_squeezed--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.predict" class="md-nav__link">
    <span class="md-ellipsis">
      predict
    </span>
  </a>
  
    <nav class="md-nav" aria-label="predict">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.predict--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.predict--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sample">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.sample--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.sample--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.to_sklearn" class="md-nav__link">
    <span class="md-ellipsis">
      to_sklearn
    </span>
  </a>
  
    <nav class="md-nav" aria-label="to_sklearn">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.to_sklearn--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.to_sklearn--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.update_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      update_parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="update_parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.update_parameters--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#gmmx.gmm.GaussianMixtureModelJax.update_parameters--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gmmx.gmm.check_shape" class="md-nav__link">
    <span class="md-ellipsis">
      check_shape
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Modules</h1>

<div class="doc doc-object doc-module">



<a id="gmmx.gmm"></a>
    <div class="doc doc-contents first">

        <p>Some notes on the implementation:</p>
<p>I have not tried to keep the implementation close to the sklearn implementation.
I have rather tried to realize my own best practices for code structure and
clarity. Here are some more detailed thoughts:</p>
<ol>
<li>
<p><strong>Use dataclasses for the model representation</strong>: this reduces the amount of
boilerplate code for initialization and in combination with the <code>register_dataclass_jax</code>
decorator it integrates seamleassly with JAX.</p>
</li>
<li>
<p><strong>Split up the different covariance types into different classes</strong>: this avoids
the need for multiple blocks of if-else statements.</p>
</li>
<li>
<p><strong>Use a registry for the covariance types</strong>:  This allows for easy extensibility
by the user.</p>
</li>
<li>
<p><strong>Remove Python loops</strong>: I have not checked the reason why the sklearn implementation
still uses Python loops, but my guess is that it is simpler(?) and when there are
operations such as matmul and cholesky decomposition, the Python loop does not become
the bottleneck. In JAX, however, it is usually better to avoid Python loops and let
the JAX compiler take care of the optimization instead.</p>
</li>
<li>
<p><strong>Rely on same internal array dimension and axis order</strong>:
Internally all(!) involved arrays (even 1d weights) are represented as 4d arrays
with the axes (batch, components, features, features_covar). This makes it much
easier to write array operations and rely on broadcasting. This minimizes the
amount of in-line reshaping and in-line extension of dimensions. If you think
about it, this is most likely the way how array programming was meant to be used
in first place. Yet, I have rarely seen this in practice, probably because people
struggle with the additional dimensions in the beginning. However once you get
used to it, it is much easier to write and understand the code! The only downside
is that the user has to face the additional "empty" dimensions when directy working
with the arrays. For convenience I have introduced properties, that return the arrays
with the empty dimensions removed. Another downside maybe that you have to use <code>keepdims=True</code>
more often, but there I would even argue that the default behavior in the array libraries
should change.</p>
</li>
<li>
<p><strong>"Poor-peoples" named axes</strong>: The axis order convention is defined in the
code in the <code>Axis</code> enum, which maps the name to the integer dimension. Later I
can use, e.g. <code>Axis.batch</code> to refer to the batch axis in the code. This is the
simplest way to come close to named axes in any array library! So you can use
e.g. <code>jnp.sum(x, axes=Axis.components)</code> to sum over the components axis. I found
this to be a very powerful concept that improves the code clarity a lot, yet I
have not seen it often in other libraries. Of course there is <code>einops</code> but the
simple enum works just fine in many cases!</p>
</li>
</ol>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="gmmx.gmm.Axis" class="doc doc-heading">
            <code>Axis</code>


<a href="#gmmx.gmm.Axis" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>int</code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Internal axis order</p>






              <details class="quote">
                <summary>Source code in <code>gmmx/gmm.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Axis</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Internal axis order&quot;&quot;&quot;</span>

    <span class="n">batch</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">components</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">features</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="n">features_covar</span> <span class="o">=</span> <span class="mi">3</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="gmmx.gmm.CovarianceType" class="doc doc-heading">
            <code>CovarianceType</code>


<a href="#gmmx.gmm.CovarianceType" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>str</code>, <code><span title="enum.Enum">Enum</span></code></p>


        <p>Convariance type</p>






              <details class="quote">
                <summary>Source code in <code>gmmx/gmm.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">CovarianceType</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">Enum</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convariance type&quot;&quot;&quot;</span>

    <span class="n">full</span> <span class="o">=</span> <span class="s2">&quot;full&quot;</span>
    <span class="n">tied</span> <span class="o">=</span> <span class="s2">&quot;tied&quot;</span>
    <span class="n">diag</span> <span class="o">=</span> <span class="s2">&quot;diag&quot;</span>
    <span class="n">spherical</span> <span class="o">=</span> <span class="s2">&quot;spherical&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="gmmx.gmm.FullCovariances" class="doc doc-heading">
            <code>FullCovariances</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Full covariance matrix</p>
<h4 id="gmmx.gmm.FullCovariances--attributes">Attributes<a class="headerlink" href="#gmmx.gmm.FullCovariances--attributes" title="Permanent link">&para;</a></h4>
<p>values : jax.array
    Covariance values. Expected shape is (1, n_components, n_features, n_features)</p>






              <details class="quote">
                <summary>Source code in <code>gmmx/gmm.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_dataclass_jax</span><span class="p">(</span><span class="n">data_fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;values&quot;</span><span class="p">])</span>
<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">FullCovariances</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Full covariance matrix</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    values : jax.array</span>
<span class="sd">        Covariance values. Expected shape is (1, n_components, n_features, n_features)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">values</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">check_shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_squeezed</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">AnyArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FullCovariances</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a covariance matrix from squeezed array</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        values : jax.Array ot np.array</span>
<span class="sd">            Covariance values. Expected shape is (n_components, n_features, n_features)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        covariances : FullCovariances</span>
<span class="sd">            Covariance matrix instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">values_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Covariance as numpy array&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">precisions_cholesky_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute precision matrices&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">precisions_cholesky</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span> <span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Device</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FullCovariances</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create covariance matrix</span>

<span class="sd">        By default the covariance matrix is set to the identity matrix.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n_components : int</span>
<span class="sd">            Number of components</span>
<span class="sd">        n_features : int</span>
<span class="sd">            Number of features</span>
<span class="sd">        device : str, optional</span>
<span class="sd">            Device, by default None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        covariances : FullCovariances</span>
<span class="sd">            Covariance matrix instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">identity</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">values</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">identity</span><span class="p">,</span> <span class="n">n_components</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">device_put</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">log_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">means</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute log likelihood from the covariance for a given feature vector</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : jax.array</span>
<span class="sd">            Feature vectors</span>
<span class="sd">        means : jax.array</span>
<span class="sd">            Means of the components</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        log_prob : jax.array</span>
<span class="sd">            Log likelihood</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">precisions_cholesky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precisions_cholesky</span>

        <span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mT</span><span class="p">,</span> <span class="n">precisions_cholesky</span><span class="p">)</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
            <span class="n">means</span><span class="o">.</span><span class="n">mT</span><span class="p">,</span> <span class="n">precisions_cholesky</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">),</span>
            <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_parameters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
        <span class="n">means</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
        <span class="n">resp</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
        <span class="n">nk</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
        <span class="n">reg_covar</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FullCovariances</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Estimate updated covariance matrix from data</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : jax.array</span>
<span class="sd">            Feature vectors</span>
<span class="sd">        means : jax.array</span>
<span class="sd">            Means of the components</span>
<span class="sd">        resp : jax.array</span>
<span class="sd">            Responsibilities</span>
<span class="sd">        nk : jax.array</span>
<span class="sd">            Number of samples in each component</span>
<span class="sd">        reg_covar : float</span>
<span class="sd">            Regularization for the covariance matrix</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        covariances : FullCovariances</span>
<span class="sd">            Updated covariance matrix instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">means</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">diff</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">resp</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">resp</span> <span class="o">*</span> <span class="n">diff</span><span class="p">,</span> <span class="n">diff</span><span class="o">.</span><span class="n">mT</span><span class="p">)</span> <span class="o">/</span> <span class="n">nk</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features</span><span class="p">)</span>
        <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">reg_covar</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of components&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_features</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of features&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of parameters&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_components</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.0</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">log_det_cholesky</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log determinant of the cholesky decomposition&quot;&quot;&quot;</span>
        <span class="n">diag</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">precisions_cholesky</span><span class="p">),</span>
            <span class="n">axis1</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span>
            <span class="n">axis2</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">diag</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">precisions_cholesky</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute precision matrices&quot;&quot;&quot;</span>
        <span class="n">cov_chol</span> <span class="o">=</span> <span class="n">jsp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="n">identity</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">identity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_components</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
        <span class="n">precisions_chol</span> <span class="o">=</span> <span class="n">jsp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve_triangular</span><span class="p">(</span><span class="n">cov_chol</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">lower</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">precisions_chol</span><span class="o">.</span><span class="n">mT</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.FullCovariances.log_det_cholesky" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_det_cholesky</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances.log_det_cholesky" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Log determinant of the cholesky decomposition</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.FullCovariances.n_components" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances.n_components" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Number of components</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.FullCovariances.n_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances.n_features" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Number of features</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.FullCovariances.n_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">n_parameters</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances.n_parameters" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Number of parameters</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.FullCovariances.precisions_cholesky" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">precisions_cholesky</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances.precisions_cholesky" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute precision matrices</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.FullCovariances.precisions_cholesky_numpy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">precisions_cholesky_numpy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances.precisions_cholesky_numpy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute precision matrices</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.FullCovariances.values_numpy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">values_numpy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances.values_numpy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Covariance as numpy array</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.FullCovariances.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances.create" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create covariance matrix</p>
<p>By default the covariance matrix is set to the identity matrix.</p>
<h5 id="gmmx.gmm.FullCovariances.create--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.FullCovariances.create--parameters" title="Permanent link">&para;</a></h5>
<p>n_components : int
    Number of components
n_features : int
    Number of features
device : str, optional
    Device, by default None</p>
<h5 id="gmmx.gmm.FullCovariances.create--returns">Returns<a class="headerlink" href="#gmmx.gmm.FullCovariances.create--returns" title="Permanent link">&para;</a></h5>
<p>covariances : FullCovariances
    Covariance matrix instance.</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span> <span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="n">Device</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FullCovariances</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create covariance matrix</span>

<span class="sd">    By default the covariance matrix is set to the identity matrix.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n_components : int</span>
<span class="sd">        Number of components</span>
<span class="sd">    n_features : int</span>
<span class="sd">        Number of features</span>
<span class="sd">    device : str, optional</span>
<span class="sd">        Device, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    covariances : FullCovariances</span>
<span class="sd">        Covariance matrix instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">identity</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">n_features</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">identity</span><span class="p">,</span> <span class="n">n_components</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">device_put</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.FullCovariances.from_squeezed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_squeezed</span><span class="p">(</span><span class="n">values</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#gmmx.gmm.FullCovariances.from_squeezed" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a covariance matrix from squeezed array</p>
<h5 id="gmmx.gmm.FullCovariances.from_squeezed--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.FullCovariances.from_squeezed--parameters" title="Permanent link">&para;</a></h5>
<p>values : jax.Array ot np.array
    Covariance values. Expected shape is (n_components, n_features, n_features)</p>
<h5 id="gmmx.gmm.FullCovariances.from_squeezed--returns">Returns<a class="headerlink" href="#gmmx.gmm.FullCovariances.from_squeezed--returns" title="Permanent link">&para;</a></h5>
<p>covariances : FullCovariances
    Covariance matrix instance.</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_squeezed</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">AnyArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FullCovariances</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a covariance matrix from squeezed array</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    values : jax.Array ot np.array</span>
<span class="sd">        Covariance values. Expected shape is (n_components, n_features, n_features)</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    covariances : FullCovariances</span>
<span class="sd">        Covariance matrix instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.FullCovariances.log_prob" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">means</span><span class="p">)</span></code>

<a href="#gmmx.gmm.FullCovariances.log_prob" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute log likelihood from the covariance for a given feature vector</p>
<h5 id="gmmx.gmm.FullCovariances.log_prob--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.FullCovariances.log_prob--parameters" title="Permanent link">&para;</a></h5>
<p>x : jax.array
    Feature vectors
means : jax.array
    Means of the components</p>
<h5 id="gmmx.gmm.FullCovariances.log_prob--returns">Returns<a class="headerlink" href="#gmmx.gmm.FullCovariances.log_prob--returns" title="Permanent link">&para;</a></h5>
<p>log_prob : jax.array
    Log likelihood</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">log_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">means</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute log likelihood from the covariance for a given feature vector</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : jax.array</span>
<span class="sd">        Feature vectors</span>
<span class="sd">    means : jax.array</span>
<span class="sd">        Means of the components</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    log_prob : jax.array</span>
<span class="sd">        Log likelihood</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">precisions_cholesky</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">precisions_cholesky</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">mT</span><span class="p">,</span> <span class="n">precisions_cholesky</span><span class="p">)</span> <span class="o">-</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span>
        <span class="n">means</span><span class="o">.</span><span class="n">mT</span><span class="p">,</span> <span class="n">precisions_cholesky</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">y</span><span class="p">),</span>
        <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">),</span>
        <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.FullCovariances.update_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_parameters</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">means</span><span class="p">,</span> <span class="n">resp</span><span class="p">,</span> <span class="n">nk</span><span class="p">,</span> <span class="n">reg_covar</span><span class="p">)</span></code>

<a href="#gmmx.gmm.FullCovariances.update_parameters" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Estimate updated covariance matrix from data</p>
<h5 id="gmmx.gmm.FullCovariances.update_parameters--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.FullCovariances.update_parameters--parameters" title="Permanent link">&para;</a></h5>
<p>x : jax.array
    Feature vectors
means : jax.array
    Means of the components
resp : jax.array
    Responsibilities
nk : jax.array
    Number of samples in each component
reg_covar : float
    Regularization for the covariance matrix</p>
<h5 id="gmmx.gmm.FullCovariances.update_parameters--returns">Returns<a class="headerlink" href="#gmmx.gmm.FullCovariances.update_parameters--returns" title="Permanent link">&para;</a></h5>
<p>covariances : FullCovariances
    Updated covariance matrix instance.</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_parameters</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="n">means</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="n">resp</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="n">nk</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="n">reg_covar</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">FullCovariances</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Estimate updated covariance matrix from data</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : jax.array</span>
<span class="sd">        Feature vectors</span>
<span class="sd">    means : jax.array</span>
<span class="sd">        Means of the components</span>
<span class="sd">    resp : jax.array</span>
<span class="sd">        Responsibilities</span>
<span class="sd">    nk : jax.array</span>
<span class="sd">        Number of samples in each component</span>
<span class="sd">    reg_covar : float</span>
<span class="sd">        Regularization for the covariance matrix</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    covariances : FullCovariances</span>
<span class="sd">        Updated covariance matrix instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">means</span>
    <span class="n">axes</span> <span class="o">=</span> <span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">diff</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">diff</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">resp</span> <span class="o">*</span> <span class="n">diff</span><span class="p">,</span> <span class="n">diff</span><span class="o">.</span><span class="n">mT</span><span class="p">)</span> <span class="o">/</span> <span class="n">nk</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features</span><span class="p">)</span>
    <span class="n">values</span> <span class="o">=</span> <span class="n">values</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="p">:,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">reg_covar</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="gmmx.gmm.GaussianMixtureModelJax" class="doc doc-heading">
            <code>GaussianMixtureModelJax</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">


        <p>Gaussian Mixture Model</p>
<h4 id="gmmx.gmm.GaussianMixtureModelJax--attributes">Attributes<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax--attributes" title="Permanent link">&para;</a></h4>
<p>weights : jax.array
    Weights of each component. Expected shape is (1, n_components, 1, 1)
means : jax.array
    Mean of each component. Expected shape is (1, n_components, n_features, 1)
covariances : jax.array
    Covariance of each component. Expected shape is (1, n_components, n_features, n_features)</p>






              <details class="quote">
                <summary>Source code in <code>gmmx/gmm.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@register_dataclass_jax</span><span class="p">(</span><span class="n">data_fields</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;weights&quot;</span><span class="p">,</span> <span class="s2">&quot;means&quot;</span><span class="p">,</span> <span class="s2">&quot;covariances&quot;</span><span class="p">])</span>
<span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">GaussianMixtureModelJax</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Gaussian Mixture Model</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    weights : jax.array</span>
<span class="sd">        Weights of each component. Expected shape is (1, n_components, 1, 1)</span>
<span class="sd">    means : jax.array</span>
<span class="sd">        Mean of each component. Expected shape is (1, n_components, n_features, 1)</span>
<span class="sd">    covariances : jax.array</span>
<span class="sd">        Covariance of each component. Expected shape is (1, n_components, n_features, n_features)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">weights</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>
    <span class="n">means</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span>
    <span class="n">covariances</span><span class="p">:</span> <span class="n">FullCovariances</span>

    <span class="k">def</span> <span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">check_shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">check_shape</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">weights_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Weights as numpy array&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">),</span>
            <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">means_numpy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Means as numpy array&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">covariance_type</span><span class="p">:</span> <span class="n">CovarianceType</span> <span class="o">=</span> <span class="n">CovarianceType</span><span class="o">.</span><span class="n">full</span><span class="p">,</span>
        <span class="n">device</span><span class="p">:</span> <span class="n">Device</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GaussianMixtureModelJax</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a GMM from configuration</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        n_components : int</span>
<span class="sd">            Number of components</span>
<span class="sd">        n_features : int</span>
<span class="sd">            Number of features</span>
<span class="sd">        covariance_type : str, optional</span>
<span class="sd">            Covariance type, by default &quot;full&quot;</span>
<span class="sd">        device : str, optional</span>
<span class="sd">            Device, by default None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gmm : GaussianMixtureModelJax</span>
<span class="sd">            Gaussian mixture model instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">covariance_type</span> <span class="o">=</span> <span class="n">CovarianceType</span><span class="p">(</span><span class="n">covariance_type</span><span class="p">)</span>

        <span class="n">weights</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_components</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">n_components</span>
        <span class="n">means</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_components</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">covariances</span> <span class="o">=</span> <span class="n">COVARIANCE</span><span class="p">[</span><span class="n">covariance_type</span><span class="p">]</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">device_put</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span>
            <span class="n">means</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">device_put</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span>
            <span class="n">covariances</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">device_put</span><span class="p">(</span><span class="n">covariances</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_squeezed</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">means</span><span class="p">:</span> <span class="n">AnyArray</span><span class="p">,</span>
        <span class="n">covariances</span><span class="p">:</span> <span class="n">AnyArray</span><span class="p">,</span>
        <span class="n">weights</span><span class="p">:</span> <span class="n">AnyArray</span><span class="p">,</span>
        <span class="n">covariance_type</span><span class="p">:</span> <span class="n">CovarianceType</span> <span class="o">=</span> <span class="n">CovarianceType</span><span class="o">.</span><span class="n">full</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GaussianMixtureModelJax</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Jax GMM from squeezed arrays</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        means : jax.Array or np.array</span>
<span class="sd">            Mean of each component. Expected shape is (n_components, n_features)</span>
<span class="sd">        covariances : jax.Array or np.array</span>
<span class="sd">            Covariance of each component. Expected shape is (n_components, n_features, n_features)</span>
<span class="sd">        weights : jax.Array or np.array</span>
<span class="sd">            Weights of each component. Expected shape is (n_components,)</span>
<span class="sd">        covariance_type : str, optional</span>
<span class="sd">            Covariance type, by default &quot;full&quot;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gmm : GaussianMixtureModelJax</span>
<span class="sd">            Gaussian mixture model instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">covariance_type</span> <span class="o">=</span> <span class="n">CovarianceType</span><span class="p">(</span><span class="n">covariance_type</span><span class="p">)</span>

        <span class="n">means</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">))</span>
        <span class="n">weights</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
            <span class="n">weights</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">values</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">covariances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
        <span class="n">covariances</span> <span class="o">=</span> <span class="n">COVARIANCE</span><span class="p">[</span><span class="n">covariance_type</span><span class="p">](</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">means</span><span class="o">=</span><span class="n">means</span><span class="p">,</span> <span class="n">covariances</span><span class="o">=</span><span class="n">covariances</span><span class="p">)</span>  <span class="c1"># type: ignore [arg-type]</span>

    <span class="k">def</span> <span class="nf">update_parameters</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">resp</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">reg_covar</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GaussianMixtureModelJax</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update parameters</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : jax.array</span>
<span class="sd">            Feature vectors</span>
<span class="sd">        resp : jax.array</span>
<span class="sd">            Responsibilities</span>
<span class="sd">        reg_covar : float</span>
<span class="sd">            Regularization for the covariance matrix</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gmm : GaussianMixtureModelJax</span>
<span class="sd">            Updated Gaussian mixture model</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nk</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">means</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">mT</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">nk</span>
        <span class="n">covariances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">update_parameters</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">means</span><span class="o">=</span><span class="n">means</span><span class="p">,</span> <span class="n">resp</span><span class="o">=</span><span class="n">resp</span><span class="p">,</span> <span class="n">nk</span><span class="o">=</span><span class="n">nk</span><span class="p">,</span> <span class="n">reg_covar</span><span class="o">=</span><span class="n">reg_covar</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
            <span class="n">weights</span><span class="o">=</span><span class="n">nk</span> <span class="o">/</span> <span class="n">nk</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">means</span><span class="o">=</span><span class="n">means</span><span class="p">,</span> <span class="n">covariances</span><span class="o">=</span><span class="n">covariances</span>
        <span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_k_means</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Init from k-means clustering</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : jax.array</span>
<span class="sd">            Feature vectors</span>
<span class="sd">        n_components : int</span>
<span class="sd">            Number of components</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gmm : GaussianMixtureModelJax</span>
<span class="sd">            Gaussian mixture model instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_features</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of features&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">n_features</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of components&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">n_components</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Number of parameters&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">int</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_components</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_components</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">n_parameters</span>
            <span class="o">-</span> <span class="mi">1</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">log_weights</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log weights (~jax.ndarray)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>

    <span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
    <span class="k">def</span> <span class="nf">estimate_log_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Compute log likelihood for given feature vector</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : jax.array</span>
<span class="sd">            Feature vectors</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        log_prob : jax.array</span>
<span class="sd">            Log likelihood</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">))</span>
        <span class="n">log_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">)</span>
        <span class="n">two_pi</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
            <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">two_pi</span><span class="p">)</span> <span class="o">+</span> <span class="n">log_prob</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">log_det_cholesky</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_weights</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">to_sklearn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert to sklearn GaussianMixture</span>

<span class="sd">        The methods sets the weights, means, precisions_cholesky and covariances_ attributes,</span>
<span class="sd">        however sklearn will overvwrite them when fitting the model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        **kwargs : dict</span>
<span class="sd">            Additional arguments passed to `~sklearn.mixture.GaussianMixture`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gmm : `~sklearn.mixture.GaussianMixture`</span>
<span class="sd">            Gaussian mixture model instance.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">sklearn.mixture</span> <span class="kn">import</span> <span class="n">GaussianMixture</span>  <span class="c1"># type: ignore [import-untyped]</span>

        <span class="n">gmm</span> <span class="o">=</span> <span class="n">GaussianMixture</span><span class="p">(</span>
            <span class="n">n_components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_components</span><span class="p">,</span>
            <span class="n">covariance_type</span><span class="o">=</span><span class="n">SKLEARN_COVARIANCE_TYPE</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="p">)],</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">gmm</span><span class="o">.</span><span class="n">weights_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_numpy</span>
        <span class="n">gmm</span><span class="o">.</span><span class="n">means_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">means_numpy</span>
        <span class="n">gmm</span><span class="o">.</span><span class="n">precisions_cholesky_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">precisions_cholesky_numpy</span>
        <span class="n">gmm</span><span class="o">.</span><span class="n">covariances_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">values_numpy</span>
        <span class="k">return</span> <span class="n">gmm</span>

    <span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Predict the component index for each sample</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        x : jax.array</span>
<span class="sd">            Feature vectors</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        predictions : jax.array</span>
<span class="sd">            Predicted component index</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">log_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">log_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">))</span>

    <span class="nd">@partial</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;n_samples&quot;</span><span class="p">])</span>
    <span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Sample from the model</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        key : jax.random.PRNGKey</span>
<span class="sd">            Random key</span>
<span class="sd">        n_samples : int</span>
<span class="sd">            Number of samples</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        samples : jax.array</span>
<span class="sd">            Samples</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

        <span class="n">selected</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
            <span class="n">key</span><span class="p">,</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_components</span><span class="p">),</span>
            <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,),</span>
        <span class="p">)</span>

        <span class="c1"># TODO: this blows up the memory, as the arrays are copied</span>
        <span class="n">means</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">,</span> <span class="n">selected</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
        <span class="n">covar</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">selected</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

        <span class="n">samples</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span>
            <span class="n">subkey</span><span class="p">,</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">)),</span>
            <span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">covar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">),</span>
            <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,),</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">samples</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.GaussianMixtureModelJax.log_weights" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">log_weights</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax.log_weights" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Log weights (~jax.ndarray)</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.GaussianMixtureModelJax.means_numpy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">means_numpy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax.means_numpy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Means as numpy array</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.GaussianMixtureModelJax.n_components" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax.n_components" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Number of components</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.GaussianMixtureModelJax.n_features" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax.n_features" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Number of features</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.GaussianMixtureModelJax.n_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">n_parameters</span><span class="p">:</span> <span class="nb">int</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax.n_parameters" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Number of parameters</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="gmmx.gmm.GaussianMixtureModelJax.weights_numpy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">weights_numpy</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax.weights_numpy" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Weights as numpy array</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.GaussianMixtureModelJax.create" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="n">covariance_type</span><span class="o">=</span><span class="n">CovarianceType</span><span class="o">.</span><span class="n">full</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax.create" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a GMM from configuration</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.create--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.create--parameters" title="Permanent link">&para;</a></h5>
<p>n_components : int
    Number of components
n_features : int
    Number of features
covariance_type : str, optional
    Covariance type, by default "full"
device : str, optional
    Device, by default None</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.create--returns">Returns<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.create--returns" title="Permanent link">&para;</a></h5>
<p>gmm : GaussianMixtureModelJax
    Gaussian mixture model instance.</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">create</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">n_features</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">covariance_type</span><span class="p">:</span> <span class="n">CovarianceType</span> <span class="o">=</span> <span class="n">CovarianceType</span><span class="o">.</span><span class="n">full</span><span class="p">,</span>
    <span class="n">device</span><span class="p">:</span> <span class="n">Device</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GaussianMixtureModelJax</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a GMM from configuration</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    n_components : int</span>
<span class="sd">        Number of components</span>
<span class="sd">    n_features : int</span>
<span class="sd">        Number of features</span>
<span class="sd">    covariance_type : str, optional</span>
<span class="sd">        Covariance type, by default &quot;full&quot;</span>
<span class="sd">    device : str, optional</span>
<span class="sd">        Device, by default None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gmm : GaussianMixtureModelJax</span>
<span class="sd">        Gaussian mixture model instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">covariance_type</span> <span class="o">=</span> <span class="n">CovarianceType</span><span class="p">(</span><span class="n">covariance_type</span><span class="p">)</span>

    <span class="n">weights</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_components</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="n">n_components</span>
    <span class="n">means</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">n_components</span><span class="p">,</span> <span class="n">n_features</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">covariances</span> <span class="o">=</span> <span class="n">COVARIANCE</span><span class="p">[</span><span class="n">covariance_type</span><span class="p">]</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">n_components</span><span class="p">,</span> <span class="n">n_features</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">device_put</span><span class="p">(</span><span class="n">weights</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span>
        <span class="n">means</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">device_put</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span>
        <span class="n">covariances</span><span class="o">=</span><span class="n">jax</span><span class="o">.</span><span class="n">device_put</span><span class="p">(</span><span class="n">covariances</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">estimate_log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Compute log likelihood for given feature vector</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob--parameters" title="Permanent link">&para;</a></h5>
<p>x : jax.array
    Feature vectors</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob--returns">Returns<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.estimate_log_prob--returns" title="Permanent link">&para;</a></h5>
<p>log_prob : jax.array
    Log likelihood</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">estimate_log_prob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Compute log likelihood for given feature vector</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : jax.array</span>
<span class="sd">        Feature vectors</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    log_prob : jax.array</span>
<span class="sd">        Log likelihood</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">))</span>
    <span class="n">log_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">)</span>
    <span class="n">two_pi</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

    <span class="n">value</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">-</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">*</span> <span class="n">jnp</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">two_pi</span><span class="p">)</span> <span class="o">+</span> <span class="n">log_prob</span><span class="p">)</span>
        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">log_det_cholesky</span>
        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_weights</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">value</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.GaussianMixtureModelJax.from_k_means" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_k_means</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n_components</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax.from_k_means" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Init from k-means clustering</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.from_k_means--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.from_k_means--parameters" title="Permanent link">&para;</a></h5>
<p>x : jax.array
    Feature vectors
n_components : int
    Number of components</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.from_k_means--returns">Returns<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.from_k_means--returns" title="Permanent link">&para;</a></h5>
<p>gmm : GaussianMixtureModelJax
    Gaussian mixture model instance.</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_k_means</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">n_components</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Init from k-means clustering</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : jax.array</span>
<span class="sd">        Feature vectors</span>
<span class="sd">    n_components : int</span>
<span class="sd">        Number of components</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gmm : GaussianMixtureModelJax</span>
<span class="sd">        Gaussian mixture model instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.GaussianMixtureModelJax.from_squeezed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_squeezed</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">covariances</span><span class="p">,</span> <span class="n">weights</span><span class="p">,</span> <span class="n">covariance_type</span><span class="o">=</span><span class="n">CovarianceType</span><span class="o">.</span><span class="n">full</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#gmmx.gmm.GaussianMixtureModelJax.from_squeezed" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Create a Jax GMM from squeezed arrays</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.from_squeezed--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.from_squeezed--parameters" title="Permanent link">&para;</a></h5>
<p>means : jax.Array or np.array
    Mean of each component. Expected shape is (n_components, n_features)
covariances : jax.Array or np.array
    Covariance of each component. Expected shape is (n_components, n_features, n_features)
weights : jax.Array or np.array
    Weights of each component. Expected shape is (n_components,)
covariance_type : str, optional
    Covariance type, by default "full"</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.from_squeezed--returns">Returns<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.from_squeezed--returns" title="Permanent link">&para;</a></h5>
<p>gmm : GaussianMixtureModelJax
    Gaussian mixture model instance.</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_squeezed</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">means</span><span class="p">:</span> <span class="n">AnyArray</span><span class="p">,</span>
    <span class="n">covariances</span><span class="p">:</span> <span class="n">AnyArray</span><span class="p">,</span>
    <span class="n">weights</span><span class="p">:</span> <span class="n">AnyArray</span><span class="p">,</span>
    <span class="n">covariance_type</span><span class="p">:</span> <span class="n">CovarianceType</span> <span class="o">=</span> <span class="n">CovarianceType</span><span class="o">.</span><span class="n">full</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GaussianMixtureModelJax</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Jax GMM from squeezed arrays</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    means : jax.Array or np.array</span>
<span class="sd">        Mean of each component. Expected shape is (n_components, n_features)</span>
<span class="sd">    covariances : jax.Array or np.array</span>
<span class="sd">        Covariance of each component. Expected shape is (n_components, n_features, n_features)</span>
<span class="sd">    weights : jax.Array or np.array</span>
<span class="sd">        Weights of each component. Expected shape is (n_components,)</span>
<span class="sd">    covariance_type : str, optional</span>
<span class="sd">        Covariance type, by default &quot;full&quot;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gmm : GaussianMixtureModelJax</span>
<span class="sd">        Gaussian mixture model instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">covariance_type</span> <span class="o">=</span> <span class="n">CovarianceType</span><span class="p">(</span><span class="n">covariance_type</span><span class="p">)</span>

    <span class="n">means</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">))</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span>
        <span class="n">weights</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">values</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">covariances</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">)</span>
    <span class="n">covariances</span> <span class="o">=</span> <span class="n">COVARIANCE</span><span class="p">[</span><span class="n">covariance_type</span><span class="p">](</span><span class="n">values</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">weights</span><span class="o">=</span><span class="n">weights</span><span class="p">,</span> <span class="n">means</span><span class="o">=</span><span class="n">means</span><span class="p">,</span> <span class="n">covariances</span><span class="o">=</span><span class="n">covariances</span><span class="p">)</span>  <span class="c1"># type: ignore [arg-type]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.GaussianMixtureModelJax.predict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

<a href="#gmmx.gmm.GaussianMixtureModelJax.predict" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Predict the component index for each sample</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.predict--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.predict--parameters" title="Permanent link">&para;</a></h5>
<p>x : jax.array
    Feature vectors</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.predict--returns">Returns<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.predict--returns" title="Permanent link">&para;</a></h5>
<p>predictions : jax.array
    Predicted component index</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Predict the component index for each sample</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : jax.array</span>
<span class="sd">        Feature vectors</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    predictions : jax.array</span>
<span class="sd">        Predicted component index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">log_prob</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estimate_log_prob</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">log_prob</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.GaussianMixtureModelJax.sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">)</span></code>

<a href="#gmmx.gmm.GaussianMixtureModelJax.sample" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Sample from the model</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.sample--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.sample--parameters" title="Permanent link">&para;</a></h5>
<p>key : jax.random.PRNGKey
    Random key
n_samples : int
    Number of samples</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.sample--returns">Returns<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.sample--returns" title="Permanent link">&para;</a></h5>
<p>samples : jax.array
    Samples</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@partial</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">jit</span><span class="p">,</span> <span class="n">static_argnames</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;n_samples&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sample from the model</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    key : jax.random.PRNGKey</span>
<span class="sd">        Random key</span>
<span class="sd">    n_samples : int</span>
<span class="sd">        Number of samples</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    samples : jax.array</span>
<span class="sd">        Samples</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">key</span><span class="p">,</span> <span class="n">subkey</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>

    <span class="n">selected</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="n">key</span><span class="p">,</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_components</span><span class="p">),</span>
        <span class="n">p</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,),</span>
    <span class="p">)</span>

    <span class="c1"># TODO: this blows up the memory, as the arrays are copied</span>
    <span class="n">means</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">means</span><span class="p">,</span> <span class="n">selected</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>
    <span class="n">covar</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">take</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">selected</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">components</span><span class="p">)</span>

    <span class="n">samples</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">multivariate_normal</span><span class="p">(</span>
        <span class="n">subkey</span><span class="p">,</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">means</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">Axis</span><span class="o">.</span><span class="n">features_covar</span><span class="p">)),</span>
        <span class="n">jnp</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">covar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">),</span>
        <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_samples</span><span class="p">,),</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">samples</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.GaussianMixtureModelJax.to_sklearn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">to_sklearn</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#gmmx.gmm.GaussianMixtureModelJax.to_sklearn" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Convert to sklearn GaussianMixture</p>
<p>The methods sets the weights, means, precisions_cholesky and covariances_ attributes,
however sklearn will overvwrite them when fitting the model.</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.to_sklearn--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.to_sklearn--parameters" title="Permanent link">&para;</a></h5>
<p>**kwargs : dict
    Additional arguments passed to <code>~sklearn.mixture.GaussianMixture</code></p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.to_sklearn--returns">Returns<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.to_sklearn--returns" title="Permanent link">&para;</a></h5>
<p>gmm : <code>~sklearn.mixture.GaussianMixture</code>
    Gaussian mixture model instance.</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_sklearn</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert to sklearn GaussianMixture</span>

<span class="sd">    The methods sets the weights, means, precisions_cholesky and covariances_ attributes,</span>
<span class="sd">    however sklearn will overvwrite them when fitting the model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    **kwargs : dict</span>
<span class="sd">        Additional arguments passed to `~sklearn.mixture.GaussianMixture`</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gmm : `~sklearn.mixture.GaussianMixture`</span>
<span class="sd">        Gaussian mixture model instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">sklearn.mixture</span> <span class="kn">import</span> <span class="n">GaussianMixture</span>  <span class="c1"># type: ignore [import-untyped]</span>

    <span class="n">gmm</span> <span class="o">=</span> <span class="n">GaussianMixture</span><span class="p">(</span>
        <span class="n">n_components</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_components</span><span class="p">,</span>
        <span class="n">covariance_type</span><span class="o">=</span><span class="n">SKLEARN_COVARIANCE_TYPE</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="p">)],</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">gmm</span><span class="o">.</span><span class="n">weights_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights_numpy</span>
    <span class="n">gmm</span><span class="o">.</span><span class="n">means_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">means_numpy</span>
    <span class="n">gmm</span><span class="o">.</span><span class="n">precisions_cholesky_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">precisions_cholesky_numpy</span>
    <span class="n">gmm</span><span class="o">.</span><span class="n">covariances_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">values_numpy</span>
    <span class="k">return</span> <span class="n">gmm</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="gmmx.gmm.GaussianMixtureModelJax.update_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">update_parameters</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">resp</span><span class="p">,</span> <span class="n">reg_covar</span><span class="p">)</span></code>

<a href="#gmmx.gmm.GaussianMixtureModelJax.update_parameters" class="headerlink" title="Permanent link">&para;</a></h3>


    <div class="doc doc-contents ">

        <p>Update parameters</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.update_parameters--parameters">Parameters<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.update_parameters--parameters" title="Permanent link">&para;</a></h5>
<p>x : jax.array
    Feature vectors
resp : jax.array
    Responsibilities
reg_covar : float
    Regularization for the covariance matrix</p>
<h5 id="gmmx.gmm.GaussianMixtureModelJax.update_parameters--returns">Returns<a class="headerlink" href="#gmmx.gmm.GaussianMixtureModelJax.update_parameters--returns" title="Permanent link">&para;</a></h5>
<p>gmm : GaussianMixtureModelJax
    Updated Gaussian mixture model</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_parameters</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">resp</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">reg_covar</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">GaussianMixtureModelJax</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Update parameters</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    x : jax.array</span>
<span class="sd">        Feature vectors</span>
<span class="sd">    resp : jax.array</span>
<span class="sd">        Responsibilities</span>
<span class="sd">    reg_covar : float</span>
<span class="sd">        Regularization for the covariance matrix</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    gmm : GaussianMixtureModelJax</span>
<span class="sd">        Updated Gaussian mixture model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nk</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="n">Axis</span><span class="o">.</span><span class="n">batch</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">means</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">mT</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">nk</span>
    <span class="n">covariances</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">covariances</span><span class="o">.</span><span class="n">update_parameters</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">means</span><span class="o">=</span><span class="n">means</span><span class="p">,</span> <span class="n">resp</span><span class="o">=</span><span class="n">resp</span><span class="p">,</span> <span class="n">nk</span><span class="o">=</span><span class="n">nk</span><span class="p">,</span> <span class="n">reg_covar</span><span class="o">=</span><span class="n">reg_covar</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="p">(</span>
        <span class="n">weights</span><span class="o">=</span><span class="n">nk</span> <span class="o">/</span> <span class="n">nk</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">means</span><span class="o">=</span><span class="n">means</span><span class="p">,</span> <span class="n">covariances</span><span class="o">=</span><span class="n">covariances</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="gmmx.gmm.check_shape" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">check_shape</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">expected</span><span class="p">)</span></code>

<a href="#gmmx.gmm.check_shape" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents ">

        <p>Check shape of array</p>

            <details class="quote">
              <summary>Source code in <code>gmmx/gmm.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">check_shape</span><span class="p">(</span><span class="n">array</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">expected</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span> <span class="o">...</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check shape of array&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">expected</span><span class="p">):</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Expected shape </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">expected</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">m</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">n</span> <span class="o">!=</span> <span class="n">m</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Expected shape </span><span class="si">{</span><span class="n">expected</span><span class="si">}</span><span class="s2">, got </span><span class="si">{</span><span class="n">array</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Maintained by <a href="https://axeldonath.com">Axel Donbath</a>.
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/adonath/gmmx" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://pypi.org/project/gmmx" target="_blank" rel="noopener" title="pypi.org" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.8 200.5c-7.7-30.9-22.3-54.2-53.4-54.2h-40.1v47.4c0 36.8-31.2 67.8-66.8 67.8H172.7c-29.2 0-53.4 25-53.4 54.3v101.8c0 29 25.2 46 53.4 54.3 33.8 9.9 66.3 11.7 106.8 0 26.9-7.8 53.4-23.5 53.4-54.3v-40.7H226.2v-13.6h160.2c31.1 0 42.6-21.7 53.4-54.2 11.2-33.5 10.7-65.7 0-108.6M286.2 404c11.1 0 20.1 9.1 20.1 20.3 0 11.3-9 20.4-20.1 20.4-11 0-20.1-9.2-20.1-20.4.1-11.3 9.1-20.3 20.1-20.3M167.8 248.1h106.8c29.7 0 53.4-24.5 53.4-54.3V91.9c0-29-24.4-50.7-53.4-55.6-35.8-5.9-74.7-5.6-106.8.1-45.2 8-53.4 24.7-53.4 55.6v40.7h106.9v13.6h-147c-31.1 0-58.3 18.7-66.8 54.2-9.8 40.7-10.2 66.1 0 108.6 7.6 31.6 25.7 54.2 56.8 54.2H101v-48.8c0-35.3 30.5-66.4 66.8-66.4m-6.7-142.6c-11.1 0-20.1-9.1-20.1-20.3.1-11.3 9-20.4 20.1-20.4 11 0 20.1 9.2 20.1 20.4s-9 20.3-20.1 20.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>